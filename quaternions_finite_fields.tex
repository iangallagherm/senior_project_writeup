% LaTex file for senior project paper investigating the structure of commutative
% sub-algebras of the generalized quaternions over finite fields.
%   Author:     Ian Gallagher
%   Advisor:    Eric Brussel
%   School:     Cal Poly San Luis Obispo
\documentclass{amsart}

\usepackage{amsmath, amsthm, amssymb, amsrefs}
\usepackage{general}
\usepackage{xcolor}
\usepackage{cleveref}


\title{Investigating the Structure of $M_2(\bF_q)$}
\author{Ian Gallagher \\ Dr. Eric Brussel}
\date{\today}

\begin{document}

\maketitle

\begin{abstract}
    We present and prove a count of the maximal commutative sub-algebras of
    $M_2(\bF_q)$, as well as counts for the individual isomorphism classes. 
\end{abstract}

\section{Introduction}
For a finite field of $q = p^m$ elements, it is possible to count the number of
vector subspaces of ${\bF_q}^n$ of a given dimension. These counts arise in
problems involving the number of points of $\bP^n_q$, the Grassmannian,
and further generalizations. % Might want citations here

This paper is meant to address a similar problem. Namely, the structure and 
count of the maximal commutative sub-algebras of $M_2(\bF_q)$. Such
sub-algebra's...

\section{Planes in $M_2(\bF_q)$}
    For a matrix $A \in M_2(\bF_q)$, we know
    \begin{enumerate}
        \item $A$'s characteristic polynomial: $p_A(X) = X^2 -\operatorname{tr}(A)X + \det(A)$.
        \item $A$'s minimum polynomial: $m_A(X) = X - A$ if $A \in \bF_q$. Otherwise, $m_A(X) = p_A(X)$.
    \end{enumerate}

    This gives an evaluation map $\epsilon_A : \bF_q[X] \rightarrow M_2(\bF_q)$ taking $f(X)$ to $f(A)$, which is a $\bF_q$-linear ring homomorphism with image $\bF_q[A] \subseteq M_2(\bF_q)$. The kernel is nontrivial, since $M_2(\bF_q)$ has finite $\bF_q$-dimension and $\bF_q[X]$ does not. It follows that $ker(\epsilon_A) = (m_A(X))$. By the First Isomorphism Theorem,
    \begin{align*}
        \frac{\bF_q[X]}{(m_A(X))} \cong \bF_q[A]
    \end{align*}

    So if $A \in M_2(\bF_q) - \bF_q$, we know $m_A(X) = p_A(X)$ is degree $2$ and $\bF_q[A]$ has $\bF_q$-dimension 2.

    Thus, we have that each such $A$ generates the unique 2 dimensional commutative sub-algebra of $M_2(\bF_q)$ containing $A$. All possible 2 dimensional commutative sub-algebra's are therefore of the form
    \begin{align*}
        \frac{\bF_q[X]}{(m_A(X))}
    \end{align*}
    for some $A \in M_2(\bF_q) - \bF_q$. The set of two dimensional commutative sub-algebra's of $M_2(\bF_q)$ must then be composed of exactly three isomorphism classes based on $m_A(X)$
    \begin{enumerate}
        \item If $m_A(X)$ is irreducible, then $\bF_q[A] \cong \bF_{q^2}$
        \item If $m_A(X)$ is reducible but not separable, then $\bF_q[A] \cong \bF_q \times \bF_q$
        \item If $m_A(X)$ is separable, then $\bF_q[A] \cong {\bF_q^2}_{nil}$ the degenerate nilpotent case.
    \end{enumerate}

    

\section{Identifying maximal commutative sub-algebras}

At this point, we have shown that each matrix $A \in M_2(\bF_q) - \bF_q$ can be identified with the unique plane generated by taking the linear span of $1$ and $A$, and that this plane belongs to one of three given isomorphism classes.
It is reasonable to ask whether this is the maximal commutative sub-algebra of $M_2(\bF_q)$ containing $A$. Indeed, if we drop the restriction of commutativity, we may easily find sub-algebra's of dimension 3.
The set of all upper triangular matrices is one such example.

To address this we state, but do not prove, a related result by Jacobson.

\begin{thm}[Jacobson~\cite{Jacobson44}]
    For an arbitrary field $k$, the maximum number $N(n)$ of linearly independent commutative matrices of $n$ rows and columns is given by the formula $N(n) = \lfloor n^2/4 \rfloor + 1$.
\end{thm}

In the case of $M_2(\bF_q)$, $n=2$ and we have that $N(2) = \lfloor 2^2/4 \rfloor + 1 = 2$. Therefore, these planes containing A are indeed maximal.

\section{Plane Counts}

\begin{theorem}\label{total-count}
    $M_2(\bF_q)$ has $q^2 + q + 1$ unique 2D commutative subalgebras.
\end{theorem}

Proof outline notes:
\begin{itemize}
    \item Each plane has $q^2$ elements.
    \item Each plane shares the $q$ elements of $\bF_q$.
    \item Each plane has trivial intersection.
    \item The planes cover all of $M_2(\bF_q)$.
\end{itemize}

\begin{proof}
    Let $E_x$ for $x \in M_2(\bF_q) - \bF_q$ be the commutative subalgbra created by the span of $1$ and $x$.
    Label $N = |\{E_x \mid x \in M_2(\bF_q) - \bF_q \}|$, the number of unique 2D commutative subalgebras. Let $x, y \in M_2(\bF_q) - \bF_q$. $E_x, E_y$ are both two dimensional $\bF_q$ algebra's so we know that $E_x \cap E_y$ is also a $\bF_q$-algebra. By dimension arguments, we have either $E_x = E_y$ or $E_x \cap E_y = \bF_q$. It follows that $\{E_x - \bF_q \mid x \in M_2(\bF_q) - \bF_q \}$ is a partition of $M_2(\bF_q) - \bF_q$. The following then holds,

    \begin{align*}
        N ( | E_x | - | \bF_q | ) &= | M_2(\bF_q) | - | \bF_q | \\
        N(q^2 - q) &= q^4 - q \\
        N(q-1) &= q^3 - 1 \\
        N &= q^2 + q + 1
    \end{align*}
    
    \end{proof} 

    \begin{lemma}\label{square-quotient-cosets}
    Let k be a field such that $\left[k : k^{\times2}\right] = 2$ and $A \in M_2(k)$. Define $S = \{\det( \lambda A ) \mid \lambda \in k^{\times} \}$.  \begin{align*}
        S =
        \begin{cases}
            \{0\}                     &\text{if } \det(A) = 0 \\
            k^{\times2}              &\text{if } \det(A) \in k^{\times2} \\
            k^{\times} - k^{\times2} &\text{if } \det(A) \in k^{\times} - k^{\times2}
        \end{cases}
    \end{align*}
%    Moreover, for elements $B, C \in kA$ if $\det(B) = \det(C) \neq 0$ then $B = C$ or $B = -C$.
\end{lemma}
\begin{proof}
    Let $A \in M_2(k)$. Then $\det(\lambda A) = \det(\lambda I)\det(A) = \lambda^2\det(A)$ where $\lambda \in k$.  If $\det(A) = 0$, then $\det(\lambda A) = 0$ for $\lambda \in k$ and $S = \{0\}$ follows. Otherwise, we know that the quotient group $k^{\times}/k^{\times2}$ has only the two cosets $k^{\times2}, k^{\times} - k^{\times2}$. So if $\det(A) \in k^{\times2}$, we have $S = \{\lambda^2 \det(A) \mid \lambda \in k^{\times}\} = k^{\times2}$ and similarly, if $\det(A) \in k^{\times} - k^{\times2}$, then $S = \{\lambda^2 \det(A) \mid \lambda \in k^{\times}\} = k^{\times} - k^{\times2}$.
\end{proof}

\begin{lemma}\label{orbit-sizes}
    Consider the following elements of $M_2(\bF_q)$.
    \begin{align*}
        x &= 
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix} \\
        y &=
        \begin{pmatrix}
            0 & 0 \\
            1 & 0
        \end{pmatrix}
    \end{align*}
    Under the conjugation action of $GL_2(\bF_q)$ on $M_2(\bF_q)$, 
    \begin{align*}
        |\mathcal{O}_x| &= q(q + 1) \\
        |\mathcal{O}_y| &= (q + 1)(q - 1)
    \end{align*}
\end{lemma}
\begin{proof}
    We may compute the size of the orbits of $x, y$ by first computing the size of their stabilizers, $G_x, G_y$, and then applying the orbit coset correspondence theorem.
    Now,
    \begin{align*}
        G_x &= \{A \in GL_2(\bF_q) \mid A \cdot x = x\} \\
            &= \{A \in GL_2(\bF_q) \mid AxA^{-1} = x\} \\
            &= \{A \in GL_2(\bF_q) \mid Ax = xA\} 
    \end{align*}
    Inevitably, matrices of the form $sx + tI$ commute with $x$ for $s,t \in \bF_q$, so if $sx + tI \in GL_2(\bF_q)$, then $sx + tI \in G_x$. These are also the only possible matrices in $G_x$ since they are the elements of the maximal commutative subalgebra containing $x$ {\color{blue} requires result citation/prior inclusion}. It now suffices to determine when $\det(sx + tI) = 0$.
    \begin{equation*}
        \det(sx+tI) =
        \begin{vmatrix}
            t & s \\
            s & t
        \end{vmatrix} = t^2 - s^2
    \end{equation*}
    Therefore, $\det(sx + tI) = 0$ when $t^2 = s^2$, so when $t = \pm s$. We have thus found precisely $q^2 - 2q + 1 = (q-1)^2$ elements of $G_x$. It follows that,
    \begin{equation*}
        [GL_2(\bF_q) : G_x] = \frac{(q^2-1)(q^2-q)}{(q-1)^2} = q(q + 1)
    \end{equation*}
    By the orbit coset correspondence theorem {\color{blue} should cite/include prior} we have that $\mathcal{O}_x = q(q + 1)$

    Similarly we have $G_y = \{A \in GL_2(\bF_q) | Ay = yA\}$ and the only possible elements of $G_y$ are those of the form $sy + tI$ for $s,t \in \bF_q$ where $sy+tI \in GL_2(\bF_q)$.
    \begin{equation*}
        \det(sy+tI) =
        \begin{vmatrix}
            t & 0 \\
            s & t
        \end{vmatrix} = t^2
    \end{equation*}
    So $\det(sy + tI) = 0$ if and only if $t = 0$. There are then $q^2 - q$ elements of $G_y$. Therefore,
    \begin{equation*}
        [GL_2(\bF_q) : G_y] = \frac{(q^2-1)(q^2-q)}{q^2 - q} = q^2 - 1
    \end{equation*}
    and we have $\mathcal{O}_y = q(q - 1)$
\end{proof}

\begin{theorem}
    \begin{align}
        |[\bF_{q^2}]|                  &= \binom{q}{2} \\
        |[\bF_q \times \bF_q]|         &= \binom{q + 1}{2} \\[0.5em]
        |[{\bF_q^2}_{nil}]|            &= q + 1
    \end{align}
\end{theorem}
\begin{proof}
The elements $x, y$ from \cref{orbit-sizes} are the rational canonical forms for all matrices with minimum polynomials $X^2 - 1$ and $X^2$ respectively. 

Since $X^2 - 1 = (X + 1)(X - 1)$ in $M_2(\bF_q)$ and $\operatorname{char}(\bF_q) \neq 2$ {\color{blue} this must be included in the introductory sections}, all of the elements of $\mathcal{O}_x$ belong to an embedding of $\bF_q \times \bF_q$. Additionally any embedding of $\bF_q \times \bF_q$ must be of this form...

Now, referring to \cref{square-quotient-cosets} we know that each plane isomorphic to $\bF_q \times \bF_q$

By \cref{total-count}, ...
\end{proof}

\begin{bibdiv}
    \begin{biblist}
        \bib{Jacobson44}{article}{
            title={Schur's Theorems on Commutative Matrices},
            author={Nathan Jacobson},
            journal={Bull. Amer. Math. Soc.},
            volume={50},
            date={1944},
            pages={431--436}
        }
    \end{biblist}
\end{bibdiv}

\end{document}
