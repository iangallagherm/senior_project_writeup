% LaTex file for senior project paper investigating the structure of commutative
% subalgebras of the generalized quaternions over finite fields.
%   Author:     Ian Gallagher
%   Advisor:    Eric Brussel
%   School:     Cal Poly San Luis Obispo
\documentclass{amsart}

\usepackage{amsmath, amsthm, amssymb, amsrefs}
\usepackage[margin=1.5in]{geometry}
\usepackage{general}
\usepackage{xcolor}
\usepackage{cleveref}


\title{Investigating the Structure of $M_2(\bF_q)$}
\author{Ian Gallagher \\ Dr. Eric Brussel}
\date{\today}

\begin{document}

\maketitle

\begin{abstract}
    We present and prove a count of the maximal commutative subalgebras of
    $M_2(\bF_q)$, as well as counts for the individual isomorphism classes. 
\end{abstract}

\section{Introduction}
For a finite field of $q = p^m$ elements, $p \neq 2$, it is possible to count the number of
vector subspaces of ${\bF_q}^n$ of a given dimension. These counts arise in
problems involving the number of points of $\bP^n_q$, the Grassmannian,
and further generalizations. % Might want citations here

This paper is meant to address a similar problem. Namely, the structure and 
count of the \textit{maximal commutative} subalgebras of $M_2(\bF_q)$, the vector space $\bF_q^4$ with matrix multiplication. Such commutative subalgebras are themselves two dimensional vector subspaces with the inherited multiplication of $M_2(\bF_q)$. We find that there are three isomorphism classes of maximal commutative subalgebras and give explicit formulas for the size of the isomorphism classes based on the size of $\bF_q$.

%We also relate the limiting ratio of these counts to similar ratios that can be computed for $M_2(\bR)$.

For the duration of the paper, $q = p^n$ for some prime $p \neq 2$.

\section{Generalized Quaternions and $M_2(\bF_q)$}
Here, we introduce an alternative formulation of $M_2(\bF_q)$ based on the generalized quaternions, an abstraction of the well-known quaternion algebra. This formulation lends itself nicely to a more general result detailing the structure of commutative subalgebras of $M_2(\bF_q)$.

\begin{defn}[Generalized Quaternions]
    Let $\bF$ be a field, $\operatorname{char} \bF \neq 2$, and fix $a,b \in \bF-\{0\}$. Then define the \textit{generalized quaternions} as
\begin{gather*}
    A_{a,b}(\bF) = \{t + xi + yj + zk : t,x,y,z \in \bF\} \\
    \text{ where }i^2 =a, j^2 = b, \text{ and } ij = -ji=k
\end{gather*}
\end{defn}

The generalized quaternions form what is known as a central simple algebra over $\bF$. That is, it is a finite diminsional \bF-algebra with center \bF and no nontrivial two-sided ideals.
{\color{blue} possibly insert proof that the generalized quaternions are a csa here}

\begin{defn}[Generalized Quaternion Norm]
\begin{align*}
    N_{a,b}:  A_{a,b}(\bF) & \rightarrow \bF  \\
    q & \mapsto q \overline{q} = t^2 -ax^2 -by^2 +abz^2 
\end{align*}
\end{defn}

It turns out that $M_2(\bF_q)$ is the only isomorphism class of generalized quaternions over $\bF_q$ but this fact is not immediately obvious. We will use the following two results to prove this.

\begin{theorem}[Wedderburn~\cite{DandF}*{pg. 854}]\label{wedderburn}
    Let $k$ be a field and $A$ a central simple algebra. Then $A \simeq M_n(D)$ for some $k$-division algebra $D$.
\end{theorem}

Refer to ~\cite{Henderson65} for a short proof of Wedderburn's Theorem.

\begin{theorem}[Chevalley-Warning~\cite{Serre}*{pg. 5}]\label{c-warning}
    Let $f_{\alpha} \in \bF_q[X_1, \dots, X_n]$ be polynomials in $n$ variables such that $\sum_{\alpha} \deg f_{\alpha} < n$ and let $V$ be the set of their common zeros in $\bF_q^n$. One has 
    \begin{align*}
        | V | \equiv 0 \pmod{p}
    \end{align*}
\end{theorem}

With these theorems, we now give a proof of the structure of the generalized quaternions over $\bF_q$.

\begin{theorem}
    $A_{a,b}(\bF_q) \cong M_2(\bF_q)$ 
\end{theorem}
\begin{proof}
    We first make use of \Cref{c-warning}. Let
    \begin{align*}
        f &= N_{a,b}(X_1 + iX_2 + jX_3 + kX_4) \\
            &= X_1^2 -aX_2^2 -bX_3^2 + abX_4^2 \\
            &\in \bF_q[X_1, X_2, X_3, X_4]
    \end{align*}
    Here, $\deg f = 2 < 4$, so Chevalley-Warning holds and $|V| \equiv 0 \pmod{p}$, where $V$ is the set of zeros of $f$. Note that $f(0,0,0,0) = 0$, so we must have $p$ divides $|V|$. Therefore, $f$ has a nontrivial zero.

    It follows that there exists $q \in A_{a,b}(\bF_q)$, $q \neq 0$, such that $N_{a,b}(q) = q \overline{q} = 0$. Therefore, q is a nontrivial zero divisor and $A_{a,b}(\bF_q)$ is not a $\bF_q$-division algebra. By \Cref{wedderburn} we must have $A_{a,b}(\bF_q) \cong M_n(D)$ for some $\bF_q$-division algebra $D$ and natural number $n$. Since $A_{a,b}(\bF_q)$ is not a division algebra, we know $n\neq1$. $A_{a,b}(\bF_q)$ has $\bF_q$-dimension $4$, so $n = 2$ and $D$ must have $\bF_q$-dimension 1, so is isomorphic to $\bF_q$.Therefore, $A_{a,b}(\bF_q) \cong M_2(\bF_q)$. 
\end{proof}

\section{Planes in $M_2(\bF_q)$}
    \begin{defn}
        For a matrix $A \in M_2(\bF_q)$, define
        \begin{enumerate}
            \item $A$'s characteristic polynomial $p_A(X) = X^2 -\operatorname{tr}(A)X + \det(A)$.
            \item $A$'s minimal polynomial $m_A(X)$ is the unique monic polynomial of smallest degree such that $m_A(A) = 0$.
        \end{enumerate}
    \end{defn}

    By the Cayley-Hamilton Theorem~\cite{DandF}*{pg. 478}, we know that $m_A(X)$ divides $p_A(X)$. So for nontrivial $A \in M_2(\bF_q)$, we observe that if $A \in \bF_q$, then $m_A(X) = X - A$. Otherwise, no minimal polynomial of degree $1$ exists, and we have $m_A(X) = p_A(X)$. 

    Define the evaluation map $\varepsilon_A : \bF_q[X] \rightarrow M_2(\bF_q)$ taking $f(X)$ to $f(A)$, which is a $\bF_q$-algebra homomorphism with image $\bF_q[A] \subseteq M_2(\bF_q)$. The kernel is nontrivial, since $M_2(\bF_q)$ has finite $\bF_q$-dimension and $\bF_q[X]$ does not. Since $\bF_q[X]$ is a principal ideal domain, it follows that $ker(\varepsilon_A) = (m_A(X))$.{\color{blue} Include more about kernel being an ideal here?} By the First Isomorphism Theorem,
    \begin{align*}
        \frac{\bF_q[X]}{(m_A(X))} \cong \bF_q[A]
    \end{align*}

    If $A \in M_2(\bF_q) - \bF_q$, we know $m_A(X) = p_A(X)$ is degree $2$ and $\bF_q[A]$ has $\bF_q$-dimension 2.

    $A$ then generates the two dimensional commutative subalgebra of $M_2(\bF_q)$ containing $A$. All possible 2 dimensional commutative subalgebras are therefore of the form
    \begin{align*}
        \frac{\bF_q[X]}{(m_A(X))}
    \end{align*}
    for some $A \in M_2(\bF_q) - \bF_q$. The set of two dimensional commutative subalgebras of $M_2(\bF_q)$ must then be composed of exactly three isomorphism classes based on $m_A(X)$
    \begin{enumerate}
        \item If $m_A(X)$ is irreducible, define $\bF_q[A] \cong \bF_{q^2}$.
        \item If $m_A(X)$ is reducible but not separable, define $\bF_q[A] \cong \bF_q \times \bF_q$.
        \item If $m_A(X)$ is separable, define $\bF_q[A] \cong {\bF_q^2}_{nil}$.
    \end{enumerate}
    The commutative subalgebra generated when $m_A(X)$ is separable can be considered a degenerate case due to the presence of nontrivial nilpotent elements which square to $0$. Since $m_A(X)$ is separable and reducible, we have $m_A(X) = (X - x)^2$ for some $x \in \bF_q$. By the definition of the minimal polynomial, we must have that $(A - x) ^ 2 = 0$. $A$ is not an element of $\bF_q$, so $A - x$ is nonzero and is therefore a nontrivial nilpotent element.
    It is worth noting that the case that $m_A(X)$ is both separable and irreducible does not require consideration since finite fields are perfect.
    

\section{Identifying maximal commutative subalgebras}

We have shown that each matrix $A \in M_2(\bF_q) - \bF_q$ generates a commutative subalgebra containing it, $\bF_q[A]$, and that this plane belongs to one of three given isomorphism classes.
Since there exists subalgebras of dimension three, such as the set of upper triangular matrices, it is reasonable to ask whether this is the maximal commutative subalgebra of $M_2(\bF_q)$ containing $A$.

To prove that there are no commutative subalgebras of dimension 3, and that $\bF_q[A]$ is therefore maximal, we return to the generalized quaternions formulation. We first introduce a useful vector notation for the generalized quaternions.

\begin{defn}[Generalized Quaternions, Vector Notation]
    Let $p = (s, \mathbf{v})$, and $q = (t, \mathbf{w})$, using the vector notation $\mathbf{v} = \langle v_1i, v_2j, v_3k \rangle$ and $\mathbf{w} = \langle w_1i, w_2j, w_3k \rangle$ with coefficients in $A_{a,b}(\bF)$. Modified dot and cross product formulas compute
    \begin{align*}
        \mathbf{v} \cdot_{a,b}  \mathbf{w} &= v_1w_1a + v_2w_2b -abv_3w_3 \\
        \mathbf{v} \times_{a,b} \mathbf{w} &=
            \left\langle\begin{vmatrix}
                v_2j & v_3k \\
                w_2j & w_3k
            \end{vmatrix},
            \begin{vmatrix}
                v_1i & v_3k \\
                w_1i & w_3k
            \end{vmatrix},
            \begin{vmatrix}
                v_1i & v_2j \\
                w_1i & w_2j
            \end{vmatrix}\right\rangle \\
                                            &= \langle (-v_2w_3 + v_3w_2)bi , (v_1w_3 - v_3w_1)aj, (v_1w_2 - v_2w_1)k \rangle
    \end{align*}
    Compare this to $\langle v_1, v_2, v_3 \rangle \times \langle w_1, w_2, w_3 \rangle = \langle v_2w_3 - v_3w_2, -v_1w_3 + v_3w_1, v_1w_2 - v_2w_1 \rangle$. Thus 
    \begin{align*}
        pq &= (st + v_1w_1a + v_2w_2b -abv_3w_3) + (sw_1 + tv_1 - v_2w_3b + v_3w_2b)i \\
           &\qquad + (sw_2 + tv_2 + v_1w_3a-v_3w_1a)j + (sw_3 + tv_3 + v_1w_2 - v_2w_1)k \\
           &= (st + \mathbf{v} \cdot \mathbf{w}, s\mathbf{w} + t\mathbf{v} + \mathbf{v} \times \mathbf{w})
    \end{align*}
\end{defn}

\begin{lemma}\label{anticommutativity}
    Let $p = (0, \mathbf{v})$, and $q = (0, \mathbf{w})$. Then $pq = qp$ if and only if $\mathbf{v} \times_{a,b} \mathbf{w} = 0$ if and only if $\langle v_1, v_2, v_3 \rangle \times \langle w_1, w_2, w_3 \rangle = 0$.
\end{lemma}
\begin{proof}
    We have $pq - qp = 2 \mathbf{v} \times \mathbf{w}$, and since $i, j, k$ are linearly independent and $\operatorname{char} k \neq 2$, $pq = qp$ if and only if $\mathbf{v} \times_{a,b} \mathbf{w} = 0$.

    Additionally, setting $\langle t_1, t_2, t_3 \rangle = \langle v_1, v_2, v_3 \rangle \times \langle w_1, w_2, w_3 \rangle$, we observe $\mathbf{v} \times_{a,b} \mathbf{w} = \langle (-bi)t_1, (-aj) t_2, (k) t_3 \rangle$. Also, $i, j, k$ are all not roots of the norm polynomial and are therefore units. 
    \begin{align*}
        N_{a,b}(i) &= i * (-i) = -a \\
        N_{a,b}(j) &= j * (-j) = -b \\
        N_{a,b}(k) &= k * (-k) = ab
    \end{align*}
    Since $i, j, k$ are units in $M_2(\bF_q)$, they cannot be zero divisors, and we have that $\mathbf{v} \times_{a,b} \mathbf{w} = 0$ if and only if $\langle v_1, v_2, v_3 \rangle \times \langle w_1, w_2, w_3 \rangle = 0$, as desired. 
\end{proof}

\begin{theorem}\label{commutative-subalgebras}
    If $K \subseteq A_{a,b}(\bF)$ is a nontrivial commutative subalgebra, then $K = \bF[\mathbf{w}]$ for some nonzero pure imaginary $\mathbf{w} \in A_{a,b}(\bF)$, and $\dim_{\bF} K = 2$.
\end{theorem}
\begin{proof}
    If $q = (t, \mathbf{w}) \in K - \bF$, then $q-t = \mathbf{w}$ is in $\bF[q]$, hence $\bF[\mathbf{w}] = \bF[q] \subseteq K$. If $p = (s, \mathbf{v}) \in K$ then since $pq = qp$, $\mathbf{v}$ is a scalar multiple of $\mathbf{w}$ by \Cref{anticommutativity}. Therefore, $K \subseteq \bF[\mathbf{w}]$. It follows that $K = \bF[\mathbf{w}]$. Finally, since $w \notin \bF$, we must have $m_{\mathbf{w}}(X) = p_{\mathbf{w}}(X)$, so $\deg(m_{\mathbf{w}}(X)) = 2$ and this completes the proof.
\end{proof}

Now, $A_{a,b}(\bF_q) \cong M_2(\bF_q)$, so \Cref{commutative-subalgebras} suffices to show that no commutative subalgebra of dimension 3 exists and we may conclude that the three isomorphism classes of commutative planes are the maximal commutative subalgebras of $M_2(\bF_q)$


%To address this we state, but do not prove, a related result by Jacobson.

%\begin{thm}[Jacobson~\cite{Jacobson44}]
%    For an arbitrary field $k$, the maximum number $N(n)$ of linearly independent commutative matrices of $n$ rows and columns is given by the formula $N(n) = \lfloor n^2/4 \rfloor + 1$.
%\end{thm}

%In the case of $M_2(\bF_q)$, $n=2$ and we have that $N(2) = \lfloor 2^2/4 \rfloor + 1 = 2$. Therefore, these planes containing A are indeed maximal.

\section{Plane Counts}

\begin{theorem}\label{total-count}
    $M_2(\bF_q)$ has $q^2 + q + 1$ unique nontrival commutative subalgebras.
\end{theorem}

\begin{proof}
    By \Cref{commutative-subalgebras}, each commutative subalgebra is of the form $\bF_q[\mathbf{w}]$ for some pure imaginary $\mathbf{w} \in M_2(\bF_q)$, and is therefore uniquely determined by the line $\bF_q \mathbf{w}$ by \Cref{anticommutativity}. The number of maximal commutative subalgebras is then the same as the number of pure imaginary lines through the origin. Since there are $q^3 -1$ choices of pure imaginaries in $M_2(\bF_q)$ and $\mathbf{w}$ has $q-1$ nonzero scalar multiples in $\bF_q$, there must then be
    \begin{align*}
        \frac{q^3 - 1}{q - 1} = q^2 + q + 1
    \end{align*}
    unique nontrivial commutative subalgebras in $M_2(\bF_q)$. 
%
    %Let $E_x$ for $x \in M_2(\bF_q) - \bF_q$ be the commutative subalgebra created by the span of $1$ and $x$.
    %Label $\Sigma = \{E_x \mid x \in M_2(\bF_q) - \bF_q \}$ and set $N = |\Sigma|$, the number of unique 2D commutative subalgebras. Let $x, y \in M_2(\bF_q) - \bF_q$. $E_x, E_y$ are both two dimensional $\bF_q$ algebras so we know that $E_x \cap E_y$ is also a $\bF_q$-algebra. By dimension arguments, either $E_x = E_y$ or $E_x \cap E_y = \bF_q$. Since $\bigcup_{E \in \Sigma}E = M_2(\bF_q)$, $\{E_x - \bF_q \mid x \in M_2(\bF_q) - \bF_q \}$ is a partition of $M_2(\bF_q) - \bF_q$. The following then holds,
%
    %\begin{align*}
    %    N ( | E_x | - | \bF_q | ) &= | M_2(\bF_q) | - | \bF_q | \\
    %    N(q^2 - q) &= q^4 - q \\
    %    N(q-1) &= q^3 - 1 \\
    %    N &= q^2 + q + 1
    %\end{align*}
%    
    \end{proof} 

%    \begin{lemma}\label{square-quotient-cosets}
%    Let k be a field such that $\left[k : k^{\times2}\right] = 2$ and $A \in M_2(k)$. Define $S = \{\det( \lambda A ) \mid \lambda \in k^{\times} \}$.  \begin{align*}
%        S =
%        \begin{cases}
%            \{0\}                     &\text{if } \det(A) = 0 \\
%            k^{\times2}              &\text{if } \det(A) \in k^{\times2} \\
%            k^{\times} - k^{\times2} &\text{if } \det(A) \in k^{\times} - k^{\times2}
%        \end{cases}
%    \end{align*}
%    Moreover, for elements $B, C \in kA$ if $\det(B) = \det(C) \neq 0$ then $B = C$ or $B = -C$.
%\end{lemma}
%\begin{proof}
%    Let $A \in M_2(k)$. Then $\det(\lambda A) = \det(\lambda I)\det(A) = \lambda^2\det(A)$ where $\lambda \in k$.  If $\det(A) = 0$, then $\det(\lambda A) = 0$ for $\lambda \in k$ and $S = \{0\}$ follows. Otherwise, we know that the quotient group $k^{\times}/k^{\times2}$ has only the two cosets $k^{\times2}, k^{\times} - k^{\times2}$. So if $\det(A) \in k^{\times2}$, we have $S = \{\lambda^2 \det(A) \mid \lambda \in k^{\times}\} = k^{\times2}$ and similarly, if $\det(A) \in k^{\times} - k^{\times2}$, then $S = \{\lambda^2 \det(A) \mid \lambda \in k^{\times}\} = k^{\times} - k^{\times2}$.
%\end{proof}

\begin{lemma}\label{orbit-sizes}
    Consider the following elements of $M_2(\bF_q)$.
    \begin{align*}
        x &= 
        \begin{pmatrix}
            0 & 1 \\
            1 & 0
        \end{pmatrix} \\
        y &=
        \begin{pmatrix}
            0 & 0 \\
            1 & 0
        \end{pmatrix}
    \end{align*}
    Under the conjugation action of $GL_2(\bF_q)$ on $M_2(\bF_q)$, 
    \begin{align*}
        |\mathcal{O}_x| &= q(q + 1) \\
        |\mathcal{O}_y| &= (q + 1)(q - 1)
    \end{align*}
    where $\mathcal{O}_x, \mathcal{O}_y$ denote the orbits of $x, y$ respectively.
\end{lemma}
\begin{proof}
    We may compute the size of the orbits of $x, y$ by first computing the size of their stabilizers, $G_x, G_y$, and then applying the Orbit-Coset Correspondence Theorem \cite{DandF}*{pg. 114}.
    Now
    \begin{align*}
        G_x &= \{A \in GL_2(\bF_q) \mid A \cdot x = x\} \\
            &= \{A \in GL_2(\bF_q) \mid AxA^{-1} = x\} \\
            &= \{A \in GL_2(\bF_q) \mid Ax = xA\} 
    \end{align*}
    Since matrix multiplication is distributive, matrices of the form $sx + tI$ commute with $x$ for $s,t \in \bF_q$, so if $sx + tI \in GL_2(\bF_q)$, then $sx + tI \in G_x$. These are also the only possible matrices in $G_x$ since they are the elements of the maximal commutative subalgebra containing $x$ (\Cref{commutative-subalgebras}). It now suffices to determine when $\det(sx + tI) = 0$.
    \begin{equation*}
        \det(sx+tI) =
        \begin{vmatrix}
            t & s \\
            s & t
        \end{vmatrix} = t^2 - s^2
    \end{equation*}
    Therefore, $\det(sx + tI) = 0$ when $t^2 = s^2$, so when $t = \pm s$. This eliminates the $q$ scalar multiples of $x + I$ and the $q$ scalar multiples of $x - I$, of which only $0$ is shared between them. We have thus found precisely $q^2 - 2q + 1 = (q-1)^2$ elements of $G_x$. It follows that
    \begin{equation*}
        [GL_2(\bF_q) : G_x] = \frac{(q^2-1)(q^2-q)}{(q-1)^2} = q(q + 1)
    \end{equation*}
    where $[GL_2(\bF_q) : G_x]$ is the index of $G_x$ in $GL_2(\bF_q)$. By the orbit coset correspondence theorem~\cite{DandF} we have that $|\mathcal{O}_x| = q(q + 1)$.

    Similarly we have $G_y = \{A \in GL_2(\bF_q) | Ay = yA\}$ and the only possible elements of $G_y$ are those of the form $sy + tI$ for $s,t \in \bF_q$ where $sy+tI \in GL_2(\bF_q)$.
    \begin{equation*}
        \det(sy+tI) =
        \begin{vmatrix}
            t & 0 \\
            s & t
        \end{vmatrix} = t^2
    \end{equation*}
    So $\det(sy + tI) = 0$ if and only if $t = 0$. There are then $q^2 - q$ elements of $G_y$. Therefore
    \begin{equation*}
        [GL_2(\bF_q) : G_y] = \frac{(q^2-1)(q^2-q)}{q^2 - q} = q^2 - 1
    \end{equation*}
    and we have $|\mathcal{O}_y| = q(q - 1)$
\end{proof}

\begin{theorem}\label{plane-counts}
    The orbits of the commutative planes in $M_2(\bF_q)$ under the conjugation action of $GL_2(\bF_q)$ are as follows {\color{blue} Maybe should continue using the orbit notation?}
    \begin{align}
        |[\bF_{q^2}]|                   &= \binom{q}{2} \\
        |[\bF_q \times \bF_q]|          &= \binom{q + 1}{2} \\[0.5em]
        |[{\bF_q^2}_{nil}]|             &= q + 1
    \end{align}
\end{theorem}
\begin{proof}
    The elements $x, y$ from \Cref{orbit-sizes} are the rational canonical forms for all matrices with minimal polynomials $X^2 - 1$ and $X^2$ respectively. Two matrices in $M_2(\bF)$ are conjugate if and only if they have the same rational canonical form~\cite{DandF}*{pg. 472}.

    Since $X^2 - 1 = (X + 1)(X - 1)$ is reducible and not separable over $\bF_q$, and $\operatorname{char}(\bF_q) \neq 2$, all of the elements of $\mathcal{O}_x$ generate a commutative subalgebra isomorphic to $\bF_q \times \bF_q$.

    Any copy of $K \subseteq M_2(\bF_q)$ isomorphic to $\bF_q \times \bF_q$ must also contain an element of $\mathcal{O}_x$. To see this, pick a nontrivial element $A \in K$ such that $A$ is orthogonal to the identity {\color{blue} we call this pure imaginary with reference to generalized quaternions. Ok to use this terminology in this case?}. Then $\operatorname{tr}(A) = 0$, and $m_A(X) = p_A(X) = X^2 + \det(A)$. We picked $A \in K$, which means that $m_A(X)$ must also be reducible and not separable. It follows that $\det(A) = -\lambda^2$ for some $\lambda \in \bF_q$. Let $B = A/\lambda \in K$ and observe $\operatorname{tr}(B) = \operatorname{tr}(A)/\lambda = 0$, $\det(B) = \det(A)/\lambda^2 = -\lambda^2/\lambda^2 = -1$. Therefore, $m_B(X) = p_B(X) = X^2 -\operatorname{tr}(B) X + \det(B) = X^2 -1$ as desired.

    Furthermore, suppose $B' \in K$ has minimum polynomial $X^2 - 1$. Then $B'$ is orthogonal to the identity as well and $B' = \alpha B$ for some $\alpha \in \bF_q^{\times}$ due to $K$ being dimension $2$. We have $-1 = \det(B') = \alpha^2 \det(B) = -\alpha^2$, so $\alpha = \pm 1$ and $B' = \pm B$. We have therefore shown that each embedding $K$ contains exactly $2$ elements of $\mathcal{O}_x$. Applying \Cref{orbit-sizes},
    {\color{blue} notational abuse here replacing K with $\bF_q \times \bF_q$}. 
    \begin{align*}
        |[\bF_q \times \bF_q]| = \frac{1}{2}|\mathcal{O}_x|
                  = \frac{q(q+1)}{2}
                  = \binom{q + 1}{2}
    \end{align*}
    Similarly, since $X^2$ is separable over $\bF_q$, all of the elements of $\mathcal{O}_y$ generate a commutative subalgebra isomorphic to ${\bF_q^2}_{nil}$. Any isomorphic copy $K$ will contain exactly $q - 1$ elements of $\mathcal{0}_y$. These are precisely the nontrivial elements of $K$ that are orthogonal to the identity. Applying \Cref{orbit-sizes},
    \begin{align*}
        |[{\bF_q^2}_{nil}]| = \frac{1}{q-1}|\mathcal{O}_x|
                            = \frac{q^2-1}{q-1}
                            = q+1
    \end{align*}

    To show $|[\bF_{q^2}]| = \binom{q}{2}$, we apply \Cref{total-count} and compute.
    \begin{align*}
        |[\bF_{q^2}]| &= q^2 + q + 1 - |[\bF_q \times \bF_q]| - |[{\bF_q^2}_{nil}]| \\
                      &= q^2 + q + 1 - \binom{q+1}{2} - (q+1) \\
                      &= q^2 - \frac{q(q+1)}{2} \\
                      &= \frac{q(q-1)}{2} \\
                      &= \binom{q}{2}
    \end{align*}
    This completes the proof.
\end{proof}
From \Cref{plane-counts} we can also find the limiting ratios of these commutative planes
\begin{cor}
    As $q \rightarrow \infty$, the ratio of commutative subalgebras of $M_2(\bF_q)$
    \begin{align*}
        |[\bF_{q^2}]| : |[\bF_q \times \bF_q]| : |[{\bF_q^2}_{nil}]|
    \end{align*}
    approaches $1 : 1 : 0$.
\end{cor}

\begin{proof}
    It suffices to show that the limit of $|[\bF_{q^2}]| / |[\bF_q \times \bF_q]|$ approaches $1$ and that the limit of  $|[{\bF_q^2}_{nil}]| / |[\bF_q \times \bF_q]|$ approaches $0$. {\color{blue} cite something here?}
    \begin{align*}
        \lim\limits_{q \rightarrow \infty} \frac{|[\bF_{q^2}]|}{|[\bF_q \times \bF_q]|}
            = \lim\limits_{q \rightarrow \infty} \frac{\binom{q}{2}}{\binom{q+1}{2}}
            = \lim\limits_{q \rightarrow \infty} \frac{q(q-1)}{2}\frac{2}{q(q+1)}
            = \lim\limits_{q \rightarrow \infty} \frac{(q-1)}{(q+1)}
            = 1
    \end{align*}
    \begin{align*}
        \lim\limits_{q \rightarrow \infty} \frac{|[{\bF_q^2}_{nil}]|}{|[\bF_q \times \bF_q]|}
            = \lim\limits_{q \rightarrow \infty} \frac{q+1}{\binom{q+1}{2}}
            = \lim\limits_{q \rightarrow \infty} (q+1)\cdot\frac{2}{q(q+1)}
            = \lim\limits_{q \rightarrow \infty} \frac{2}{q}
            = 0
    \end{align*}
\end{proof}



\begin{bibdiv}
    \begin{biblist}
        \bib{Henderson65}{article}{
            title={A short proof of Wedderburn's theorem},
            author={D. W. Henderson},
            journal={Amer. Math. Monthly},
            volume={72},
            date={1965},
            pages={385--386}
        }
        \bib{Serre}{book}{
            title={A Course in Arithmetic},
            author={Jean-Pierre Serre},
            publisher={Springer-Verlag},
            address={New York},
            date={1973},
            pages={5}
        }
        \bib{DandF}{book}{
            title={Abstract Algebra},
            edition={third edition},
            author={D. S. Dummit and R. M. Foote},
            publisher={John Wiley \& Sons, Inc.},
            address={Hoboken, New Jersey},
            date={2004},
            pages={114, 472}
        }
    \end{biblist}
\end{bibdiv}

\end{document}
